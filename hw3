Answer following questions
1.	In SQL Server, assuming you can find the result by using both joins and subqueries, which one would you prefer to use and why?
Joins, the reason is that join performance better and faster than subqueries.
2.	What is CTE and when to use it?
CTE stands for Common Table Expression. The usage sceneraios usually consists of SELECT, INSERT, UPDATE, or DELETE statement.
3.	What are Table Variables? What is their scope and where are they created in SQL Server?
The same as local variables in normal programing languages. The common use start with @varibles_name TABLE(values...)
4.	What is the difference between DELETE and TRUNCATE? Which one will have better performance and why?
TRUNCATE removes all the records and DELETE can remove some of the records. TRUNCATE will performe better as it deallocates the data pages instead of rows and records data pages instead of rows in transaction logs.
5.	What is Identity column? How does DELETE and TRUNCATE affect it?
An identity column is a column in a database table that is made up of values generated by the database.  I am not so sure about that.

Write queries for following scenarios
All scenarios are based on Database NORTHWND.

--1.	List all cities that have both Employees and Customers.
select distinct(city) from Customers where city in (select city from Employees)
--2.	List all cities that have Customers but no Employee.
--a.	Use sub-query
select distinct(city) from Customers where city not in (select city from Employees)
--b.	Do not use sub-query
select distinct(c.city) from Customers as c join Employees as e on e.City != c.City
--3.	List all products and their total order quantities throughout all orders.
select p.productname, o_d.quantity from [Order Details] as o_d join products as p on p.ProductID = o_d.ProductID order by  o_d.quantity desc
--4.	List all Customer Cities and total products ordered by that city.
select  distinct(city), count(orderid) as ProductsNumber from Customers as c join orders as o on o.CustomerID = c.CustomerID group by city order by ProductsNumber desc
--5.	List all Customer Cities that have at least two customers.
--a.	Use union
select  distinct(city) from Customers group by city having count(CustomerID) >= 2
--b.	Use sub-query and no union
select  distinct(city) from Customers where city in (select  distinct(city) from Customers group by city having count(CustomerID) >= 2)
--6.	List all Customer Cities that have ordered at least two different kinds of products.
select city from Customers join [Order Details] as od on od.OrderID = OrderID group by city having count(od.ProductID) >= 2
--7.	List all Customers who have ordered products, but have the ‘ship city’ on the order different from their own customer cities.
select distinct(city) from Customers join [Orders] as od on od.OrderID = OrderID where od.ShipCity != City
--8.	List 5 most popular products, their average price, and the customer city that ordered most quantity of it.
select productname, avg(p.UnitPrice * Quantity) as AveragePrice, ShipCity from Products as p join [Order Details] as od on p.ProductID = od.ProductID join Orders as o on o.OrderID = od.OrderID group by ProductName, ShipCity, Quantity order by Quantity desc
--9.	List all cities that have never ordered something but we have employees there.
--a.	Use sub-query
select city from Employees where city not in (select shipcity from [Orders])
--b.	Do not use sub-query
select distinct(e.city) from Employees as e left join Customers as c on c.City = e.City where c.City is null
--10.	List one city, if exists, that is the city from where the employee sold most orders (not the product quantity) is, and also the city of most total quantity of products ordered from. (tip: join  sub-query)
select * from
(select Top 1 e.City, count(o.OrderID) countOrder from Employees e inner join Orders o on e.EmployeeID = o.EmployeeID group by e.City) T1
inner join (select Top 1 c.City, count(r.Quantity) countQuantity from [Order Details] r inner join Orders d on r.OrderID = d.OrderID inner join Customers c on c.CustomerID = d.CustomerID group by c.City) T2 on T1.City = T2.City
--11. How do you remove the duplicates record of a table?
--Find duplicate rows using GROUP BY clause or ROW_NUMBER() function.
--Use DELETE statement to remove the duplicate rows.

--12. Sample table to be used for solutions below- Employee (empid integer, mgrid integer, deptid integer, salary money) Dept (deptid integer, deptname varchar(20))

-- Find employees who do not manage anybody.

--13. Find departments that have maximum number of employees. (solution should consider scenario having more than 1 departments that have maximum number of employees). Result should only have - deptname, count of employees sorted by deptname.

--14. Find top 3 employees (salary based) in every department. Result should have deptname, empid, salary sorted by deptname and then employee with high to low salary.
